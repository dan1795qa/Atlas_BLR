<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–¢–µ—Å—Ç: –ì–æ—Ä–æ–¥–∞ –ë–µ–ª–∞—Ä—É—Å–∏</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      h1 {
        color: white;
        text-align: center;
        margin-bottom: 30px;
        font-size: 36px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .status {
        background: white;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .status h2 {
        color: #333;
        margin-bottom: 15px;
      }

      .status-item {
        padding: 10px;
        margin: 5px 0;
        border-radius: 5px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .status-item.success {
        background: #d4edda;
        color: #155724;
      }

      .status-item.error {
        background: #f8d7da;
        color: #721c24;
      }

      .cities-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .city-card {
        background: white;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .city-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      }

      .city-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 15px;
        padding-bottom: 15px;
        border-bottom: 2px solid #eee;
      }

      .city-marker {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 3px solid white;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        animation: pulse 2s ease-out infinite;
      }

      @keyframes pulse {
        0% {
          box-shadow: 0 0 0 0 rgba(33, 150, 243, 0.6);
        }
        50% {
          box-shadow: 0 0 0 15px rgba(33, 150, 243, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(33, 150, 243, 0);
        }
      }

      .city-marker.capital {
        width: 50px;
        height: 50px;
        animation: pulse-capital 2s ease-out infinite;
      }

      @keyframes pulse-capital {
        0% {
          box-shadow: 0 0 0 0 rgba(255, 99, 71, 0.7);
        }
        50% {
          box-shadow: 0 0 0 20px rgba(255, 99, 71, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(255, 99, 71, 0);
        }
      }

      .city-name {
        flex: 1;
      }

      .city-name h3 {
        color: #333;
        font-size: 24px;
        margin-bottom: 5px;
      }

      .city-badge {
        display: inline-block;
        padding: 4px 12px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .city-badge.capital {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      }

      .city-description {
        background: #f8f9fa;
        padding: 12px;
        border-left: 4px solid #0066cc;
        border-radius: 4px;
        font-style: italic;
        color: #666;
        margin-bottom: 15px;
      }

      .city-info {
        display: grid;
        gap: 10px;
      }

      .info-row {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid #eee;
      }

      .info-row:last-child {
        border-bottom: none;
      }

      .info-label {
        font-weight: 600;
        color: #555;
      }

      .info-value {
        color: #333;
        text-align: right;
      }

      .nationalities {
        margin-top: 15px;
        padding-top: 15px;
        border-top: 2px solid #eee;
      }

      .nationalities h4 {
        color: #555;
        margin-bottom: 10px;
        font-size: 14px;
      }

      .nationality-bar {
        margin-bottom: 8px;
      }

      .nationality-label {
        display: flex;
        justify-content: space-between;
        font-size: 12px;
        margin-bottom: 3px;
        color: #666;
      }

      .bar-container {
        background: #e9ecef;
        border-radius: 10px;
        height: 8px;
        overflow: hidden;
      }

      .bar-fill {
        height: 100%;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        border-radius: 10px;
        transition: width 0.5s ease;
      }

      .summary {
        background: white;
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .summary h2 {
        color: #333;
        margin-bottom: 15px;
      }

      .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
      }

      .summary-item {
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
        text-align: center;
      }

      .summary-value {
        font-size: 28px;
        font-weight: bold;
        color: #667eea;
        margin-bottom: 5px;
      }

      .summary-label {
        font-size: 14px;
        color: #666;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üèôÔ∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –ì–æ—Ä–æ–¥–∞ –ë–µ–ª–∞—Ä—É—Å–∏</h1>

      <div class="status">
        <h2>üìä –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏</h2>
        <div id="loadingStatus"></div>
      </div>

      <div id="citiesContainer" class="cities-grid"></div>

      <div class="summary">
        <h2>üìà –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
        <div class="summary-grid" id="summaryContainer"></div>
      </div>
    </div>

    <script>
      // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ –≥–æ—Ä–æ–¥–∞—Ö
      fetch("../assets/data/belarus-regions.geojson")
        .then((response) => response.json())
        .then((data) => {
          const statusDiv = document.getElementById("loadingStatus");
          const citiesContainer = document.getElementById("citiesContainer");
          const summaryContainer = document.getElementById("summaryContainer");

          // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –≥–æ—Ä–æ–¥–∞ (Point)
          const cities = data.features.filter(
            (f) => f.geometry.type === "Point"
          );

          // –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏
          statusDiv.innerHTML = `
                    <div class="status-item success">
                        ‚úÖ GeoJSON —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ
                    </div>
                    <div class="status-item success">
                        ‚úÖ –ù–∞–π–¥–µ–Ω–æ –≥–æ—Ä–æ–¥–æ–≤: ${cities.length}
                    </div>
                `;

          // –°–æ—Ä—Ç–∏—Ä—É–µ–º –≥–æ—Ä–æ–¥–∞ –ø–æ –Ω–∞—Å–µ–ª–µ–Ω–∏—é (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)
          cities.sort(
            (a, b) => b.properties.population - a.properties.population
          );

          // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –≥–æ—Ä–æ–¥–æ–≤
          cities.forEach((city, index) => {
            const props = city.properties;
            const isCapital = props.isCapital || props.name === "–ú–∏–Ω—Å–∫";
            const density = (props.population / props.area).toFixed(1);

            const cityCard = document.createElement("div");
            cityCard.className = "city-card";
            cityCard.style.animationDelay = `${index * 0.1}s`;

            let nationalitiesHTML = "";
            Object.entries(props.nationalities).forEach(([name, percent]) => {
              nationalitiesHTML += `
                            <div class="nationality-bar">
                                <div class="nationality-label">
                                    <span>${name}</span>
                                    <span>${percent}%</span>
                                </div>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: ${percent}%"></div>
                                </div>
                            </div>
                        `;
            });

            cityCard.innerHTML = `
                        <div class="city-header">
                            <div class="city-marker ${
                              isCapital ? "capital" : ""
                            }" 
                                 style="background-color: ${props.color}"></div>
                            <div class="city-name">
                                <h3>${props.name}</h3>
                                <span class="city-badge ${
                                  isCapital ? "capital" : ""
                                }">
                                    ${isCapital ? "–°—Ç–æ–ª–∏—Ü–∞" : "–û–±–ª–∞—Å—Ç–Ω–æ–π —Ü–µ–Ω—Ç—Ä"}
                                </span>
                            </div>
                        </div>

                        ${
                          props.description
                            ? `
                            <div class="city-description">
                                üìç ${props.description}
                            </div>
                        `
                            : ""
                        }

                        <div class="city-info">
                            <div class="info-row">
                                <span class="info-label">üë• –ù–∞—Å–µ–ª–µ–Ω–∏–µ</span>
                                <span class="info-value">${props.population.toLocaleString(
                                  "ru-RU"
                                )} —á–µ–ª.</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">üìè –ü–ª–æ—â–∞–¥—å</span>
                                <span class="info-value">${props.area.toLocaleString(
                                  "ru-RU"
                                )} –∫–º¬≤</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">üìä –ü–ª–æ—Ç–Ω–æ—Å—Ç—å</span>
                                <span class="info-value">${density} —á–µ–ª/–∫–º¬≤</span>
                            </div>
                            ${
                              props.founded
                                ? `
                                <div class="info-row">
                                    <span class="info-label">üèõÔ∏è –ì–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω–∏—è</span>
                                    <span class="info-value">${props.founded} –≥.</span>
                                </div>
                            `
                                : ""
                            }
                            <div class="info-row">
                                <span class="info-label">üìç –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã</span>
                                <span class="info-value">${city.geometry.coordinates[1].toFixed(
                                  4
                                )}¬∞N, ${city.geometry.coordinates[0].toFixed(
              4
            )}¬∞E</span>
                            </div>
                        </div>

                        <div class="nationalities">
                            <h4>üåç –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–æ—Å—Ç–∞–≤</h4>
                            ${nationalitiesHTML}
                        </div>
                    `;

            citiesContainer.appendChild(cityCard);
          });

          // –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
          const totalPopulation = cities.reduce(
            (sum, c) => sum + c.properties.population,
            0
          );
          const totalArea = cities.reduce(
            (sum, c) => sum + c.properties.area,
            0
          );
          const avgDensity = (totalPopulation / totalArea).toFixed(1);
          const oldestCity = cities.reduce((oldest, c) =>
            !oldest || c.properties.founded < oldest.properties.founded
              ? c
              : oldest
          );
          const youngestCity = cities.reduce((youngest, c) =>
            !youngest || c.properties.founded > youngest.properties.founded
              ? c
              : youngest
          );

          summaryContainer.innerHTML = `
                    <div class="summary-item">
                        <div class="summary-value">${cities.length}</div>
                        <div class="summary-label">–í—Å–µ–≥–æ –≥–æ—Ä–æ–¥–æ–≤</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">${(
                          totalPopulation / 1000000
                        ).toFixed(2)}M</div>
                        <div class="summary-label">–û–±—â–µ–µ –Ω–∞—Å–µ–ª–µ–Ω–∏–µ</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">${totalArea.toFixed(0)}</div>
                        <div class="summary-label">–û–±—â–∞—è –ø–ª–æ—â–∞–¥—å (–∫–º¬≤)</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">${avgDensity}</div>
                        <div class="summary-label">–°—Ä–µ–¥–Ω—è—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">${
                          oldestCity.properties.name
                        }</div>
                        <div class="summary-label">–°–∞–º—ã–π –¥—Ä–µ–≤–Ω–∏–π (${
                          oldestCity.properties.founded
                        })</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value">${
                          youngestCity.properties.name
                        }</div>
                        <div class="summary-label">–°–∞–º—ã–π –º–æ–ª–æ–¥–æ–π (${
                          youngestCity.properties.founded
                        })</div>
                    </div>
                `;
        })
        .catch((error) => {
          const statusDiv = document.getElementById("loadingStatus");
          statusDiv.innerHTML = `
                    <div class="status-item error">
                        ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}
                    </div>
                `;
        });
    </script>
  </body>
</html>
